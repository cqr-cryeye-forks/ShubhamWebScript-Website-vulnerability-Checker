#!/usr/bin/env python
# ShubhamWebScript is a Web Applications Security Scanner
# By Shubham Kumar Sinha - hinhiteachcomputer@gmail.com

import requests
import re
import time


class Colors:
    def __init__(self):
        self.green = "\033[92m"
        self.blue = "\033[94m"
        self.bold = "\033[1m"
        self.yellow = "\033[93m"
        self.red = "\033[91m"
        self.end = "\033[0m"


ga = Colors()


class HTTP_HEADER:
    HOST = "Host"
    SERVER = "Server"


def headers_reader(url):
    # This function will print the server headers such as WebServer OS & Version.
    print(ga.bold + " \n [!] Fingerprinting the backend Technologies." + ga.end)
    try:
        response = requests.get(url)
        if response.status_code == 200:
            print(ga.green + " [!] Status code: 200 OK" + ga.end)
        elif response.status_code == 404:
            print(ga.red + " [!] Page was not found! Please check the URL \n" + ga.end)
            return
    except requests.RequestException as e:
        print(ga.red + f" [!] Request failed: {e}" + ga.end)
        return

    headers = response.headers
    Host = url.split("/")[2]
    Server = headers.get(HTTP_HEADER.SERVER, "Unknown")

    print(ga.green + " [!] Host: " + str(Host) + ga.end)
    print(ga.green + " [!] WebServer: " + str(Server) + ga.end)

    for item in headers.items():
        if "x-powered-by" in item[0].lower():
            print(ga.green + " [!] " + str(item[1]).strip() + ga.end)
